[![License](https://img.shields.io/badge/License-BSD\%202--Clause-orange.svg)](https://opensource.org/licenses/BSD-2-Clause)


# TMB_plotting_function

```
plotTMB(inputDF, scale, Yrange = "adapt", cutoff = 1, output = "TMB_plot.pdf")
```
## Usage

1. **inputDF**:  *A panda dataframe containing two columns and however many rows of samples.* 
    ```
    Column 1 is the category the sample belongs to. 
    Column 2 is the number of mutations in that sample.
    ```            
    **Example:**
    
    | Column1 | Column2 |
    |-------------|-------|
    | Bladder-TCC | 25212 |
    | Bladder-TCC | 31114 |
    | Bladder-TCC | 36432 |
    

2. **scale**:  *The number of base pairs sequenced in each sample.*

    The options are:

    * "exome", which assumes sequencing size of 55 Mb
    * "genome", which assumes sequencing size of 2800 Mb
    * An integer indicating the scale of the sequencing
    
3. **Yrange**:  *The range of Yaxis.*
    ```
    The options are:
    "adapt", which will make the plot automatically adapt to the given datase
    "cancer", which will set the range to 0.001 to 1000
    A list of two numbers of powers of 10 indicating the Y-axis range. Example: [0.1,100]
    ```
4. **cutoff**:  *The minimum number of mutations required in a sample to be included in a plot*
    ```
    defaulted at 1, must be larger than or equal to 0
    ```
5. **output**:  *outputfile name*
    ```
    defaulted at "TMB_plot.pdf"
    ```
6. **redbar**:  *redbar location*
    ```
    The redbar value can either be "median" or "mean" which is the value at which the red bar appears, default is "median"
    ```
7. **yaxis**:  *Whether to show yaxis label or not*
    ```
    Defaulted at False
    ```
8. **ascend**:  *Wether to arrange data in ascending order of the height of the redbar*
    ```
    Defaulted at True
    ```
9. **leftm**:  *left margin*
    ```
    Defaulted at 1
    ```
10. **rightm**:  *right margin*
    ```
    Defaulted at 0.3
    ```
11. **topm**:  *top margin*
    ```
    Defaulted at 1
    ```
12. **bottomm**:  *bottom margin*
    ```
    Defaulted at 1
    ```
## Examples

Exmaple 1:  The full PCAWG dataset at default setting
```
inputDF = pd.read_table('exmapleInput1_pcawg.txt')
plotTMB(inputDF,"genome")
```
![ ](plots/E1_default.png?raw=true "Exmaple 1: full PCAWG dataset")

Exmaple 2:  The full PCAWG dataset with redbar set at mean
```
inputDF = pd.read_table('exmapleInput1_pcawg.txt',redbar="mean")
plotTMB(inputDF,"genome", readbar = "mean")
```
![ ](plots/E1_mean.png?raw=true "Exmaple 2: full PCAWG dataset")

Exmaple 3:  The full PCAWG dataset with decending order
```
inputDF = pd.read_table('exmapleInput1_pcawg.txt',ascend=False)
plotTMB(inputDF, scale = "genome")
```
![ ](plots/E1_descend.png?raw=true "Exmaple 3: full PCAWG dataset")

Example 4:  Subtset of PCAWG dataset with Y axis adapts to input data
```
inputDF = pd.read_table('exmapleInput2_pcawg_less.txt')
plotTMB(inputDF, scale = "genome", Yrange = "adapt")
```
![ ](plots/E2_adapt.png?raw=true "Example 4:Y axis adapts to input data")


Example 5:  Y axis set for standard cancer TMB range
```
inputDF = pd.read_table('exmapleInput2_pcawg_less.txt')
plotTMB(inputDF, scale = "genome", Yrange = "cancer")
```
![ ](plots/E2_cancer.png?raw=true "Example 5:Y axis set for standard cancer TMB")


Exmaple 6:  Using custome input value for sequencing scale and Y axis range
```
inputDF = pd.read_table('exmapleInput2_pcawg_less.txt')
plotTMB(inputDF, scale = 2800, Yrange = [0.1,10])
```
![ ](plots/E2_custome.png?raw=true "Exmaple 6: custome input value for sequencing scale and Y axis range")


Exmaple 7:  Using cutoff to remove lower end outliers
```
inputDF = pd.read_table('exmapleInput3_signature.txt')
plotTMB(inputDF,"genome",cutoff =2)
```
![ ](plots/E3_cutoff.png?raw=true "Exmaple 7: Cutoff")

## TODO

- [ ] make a wrapper with argparse